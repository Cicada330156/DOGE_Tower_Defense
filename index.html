<doctype html>
<head>
    	<title>Doge castle defense</title> 
	<style>
		body{
			margin: 0;
		}
		canvas{
			display: block;
			margin-left: auto;
			margin-right: auto;
		}
	</style>
</head>
<body>
	<canvas id="gamePanel"></canvas>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/5.1.3/pixi.min.js"></script>
	<script type="text/javascript">
		const canvas = document.getElementById('gamePanel');
		const app = new PIXI.Application({
			view: canvas,
			width: window.innerWidth * 0.9,
			height: window.innerHeight * 0.9,
			backgroundColor: 0x7cfc00
		});

		/*let cateSpawner = new PIXI.Ticker;
		cateSpawner.minFPS = 0;
		cateSpawner.maxFPS = 0.5;
		cateSpawner.add(spawn);
		cateSpawner.start();*/
		function spawn(){
			console.log("cate!");
			//for (i = 0; i < 1; i++) {
				const cate = new PIXI.Sprite(thiefCate); 
				cate.currentSegment = 0;
				cates.push(cate);
				app.stage.addChild(cate);
			//}
		}
		var cateInterval = 2000;
		var lastCate = 0;
		console.log(lastCate);

		const thiefCate = PIXI.Texture.from('https://cdn.discordapp.com/emojis/569160672739590174.png?v=1');
		let cates = [];
		cateSpeed = 1;

		const catePath = [[100, 100], [200, 200], [300, 200]]
		console.log(catePath);

		app.ticker.add(animate);

		function followPath (p1, p2, index) {
			if (p1 == p2) {
				cates[index].currentSegment++;
				return;
			}
		}

		spawn();

		catePos = 0;
		frame = 0;
		lastFrame = (Date.now());
		function animate() {
			if (frame % 30 == 0) {
				catePos++;
			};
			if (Date.now() - cateInterval >= lastCate) {
				lastCate = Date.now();
				console.log(Date.now());
				spawn();
			}
			//cates[0].position.x = catePath[catePos % catePath.length][0]
			//cates[0].position.y = catePath[catePos % catePath.length][1]
			for (var i = 0; i < cates.length; i++) {
				cates[i].x += ((Date.now()-lastFrame)/1000*60/cateSpeed);
			}

			frame++;
			lastFrame = Date.now();
		}
	</script>
</body>
