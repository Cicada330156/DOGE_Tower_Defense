<doctype html>
<head>
    	<title>Doge castle defense</title> 
	<style>
		body{
			margin: 0;
		}
		canvas{
			display: block;
			margin-left: auto;
			margin-right: auto;
		}
	</style>
</head>
<body>
	<canvas id="gamePanel"></canvas>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/5.1.3/pixi.min.js"></script>
	<script type="text/javascript">
		const canvas = document.getElementById('gamePanel');
		const app = new PIXI.Application({
			view: canvas,
			width: window.innerWidth * 0.9,
			height: window.innerHeight * 0.9,
			backgroundColor: 0x7cfc00,
			autostart: false
		});

		const catePath = [[100, 100], [200, 200], [300, 200]];
		//console.log(catePath);

		const thiefCate = PIXI.Texture.from('https://cdn.discordapp.com/emojis/569160672739590174.png?v=1');
		let cates = [];
		function spawn() {
			for (i = 0; i < 1; i++) {
				let cate = new PIXI.Sprite(thiefCate); 
				cate.currentSegment = 0;
				app.stage.addChild(cate);
				cates.push(cate);
			}
		}

		function followPath (p1, p2, index) {
			if (p1 == p2) {
				cates[index].currentSegment++;
				return;
			}
		}
		
		catePos = 0;
		frame = 0;
		app.ticker.add(animate);
		function animate() {
			console.log(cates);
			if (frame % 120 == 0) {
				spawn();
			}
			for (var i = 0; i < cates.length; i++) {
				cates[i].x++;
			}
			for (var i = 0; i < cates.length - 1; i++) {
				if (cates[i].x >= app.renderer.width/2) {
					//console.log("sprite destroyed: " + cates + " within cates[]");
					console.log(cates);
					app.stage.removeChild(cates[i]);
					cates.splice(i, 1);
					//cates[i].destroy(true);
				}
			}
			frame++;
		}
		app.ticker.start();
	</script>
</body>
